/* ===========================
   HEARTSTRINGS — MENU CHASSIS + FX
   - Panel is fixed viewport
   - Only menu region scrolls
   - Embers behind
   - Fullscreen frame overlay on top
   =========================== */

:root{
  --text: #d8d2c7;
  --muted: rgba(216,210,199,.70);
  --rule: rgba(255,255,255,.10);

  --bg0:#050609;
  --bg1:#0b0e13;

  /* Heartstrings background texture (BASE) */
  --charcoalTex: url("./assets/apoth-bg.png");

  /* Heartstrings frame overlay (FULLSCREEN) */
  --frameImg: url("./assets/heartstrings-frame.png");
  --frameOpacity: .96;

  /* Copper */
  --c1:#f6e3ce;
  --c2:#e6bf9a;
  --c3:#c57b54;
  --c4:#8d432a;

  --copperGrad: linear-gradient(
    180deg,
    var(--c1) 0%,
    var(--c2) 18%,
    var(--c3) 48%,
    var(--c2) 72%,
    var(--c4) 100%
  );

  --pad: clamp(14px, 2.2vw, 22px);
  --radius: 18px;

  /* Spacing logic */
  --wardSafeX: 34px;
  --wardSafeY: 44px;

  /* Header button safety */
  --btnRailPad: 18px;
  --btnGap: 16px;

  /* Readability tuning */
  --menuMaxW: 880px;
  --sectionMaxW: 760px;

  /* Embers */
  --emberOpacity: .85;
}

*{ box-sizing:border-box; }

html, body{
  height: 100%;
  margin: 0;
  padding: 0;
  background: var(--bg0); /* HARD fallback (kills any white) */
}

body{
  font-family: ui-serif, Georgia, "Times New Roman", serif;
  color: var(--text);

  /* ✅ critical: body never scrolls */
  overflow: hidden;

  /* ✅ FIX: apoth-bg is the REAL base background (not just a blend overlay) */
  background:
    radial-gradient(120% 90% at 50% 12%, rgba(255,255,255,.05), transparent 60%),
    radial-gradient(120% 120% at 50% 50%, transparent 55%, rgba(0,0,0,.82) 100%),
    linear-gradient(180deg, rgba(11,14,19,.72), rgba(5,6,9,.92)),
    var(--charcoalTex);
  background-repeat: no-repeat, no-repeat, no-repeat, no-repeat;
  background-size: cover, cover, cover, cover;
  background-position: center, center, center, center;
  background-attachment: scroll, scroll, scroll, scroll;
}

/* film grain */
body::before{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: .12;
  background:
    repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, rgba(0,0,0,.03) 1px 2px),
    repeating-linear-gradient(90deg, rgba(255,255,255,.02) 0 1px, rgba(0,0,0,.02) 1px 3px);
}

/* OPTIONAL: extra texture shimmer (safe; not required for “no white”) */
body::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: .14;                 /* reduced so it can't “wash out” */
  background-image: var(--charcoalTex);
  background-repeat: repeat;
  background-size: 900px 900px;
  mix-blend-mode: overlay;       /* gentler than soft-light in dark scenes */
}

/* FX canvases (never block interaction) */
#embers, #runes{
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}
#embers{ z-index: 1; opacity: var(--emberOpacity); }
#runes{ z-index: 5; opacity: 0; }

/* ✅ FULLSCREEN frame overlay */
.frame{
  position: fixed;
  inset: 0;
  z-index: 6;
  pointer-events: none;

  background-image: var(--frameImg);
  background-repeat: no-repeat;
  background-size: 100% 100%; /* stretch to fit any screen */
  background-position: center;
  opacity: var(--frameOpacity);

  filter: drop-shadow(0 18px 45px rgba(0,0,0,.62));
}

/* Panel viewport */
.panel{
  position: relative;
  z-index: 3;

  width: min(980px, 92vw);
  height: min(92vh, 980px);
  margin: clamp(16px, 3.5vh, 44px) auto;

  display: flex;
  flex-direction: column;

  border-radius: var(--radius);
  overflow: hidden;

  background: linear-gradient(180deg, rgba(6,8,10,.22), rgba(6,8,10,.08));
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);

  box-shadow: 0 18px 70px rgba(0,0,0,.65);
  border: 1px solid rgba(255,255,255,.06);
}

/* Header */
.top{
  padding: var(--pad);
  padding-top: calc(var(--pad) + 10px);
  text-align: center;
  border-bottom: 1px solid var(--rule);
  position: relative;
  z-index: 4;
}

.kicker{
  font-size: clamp(18px, 2.2vw, 26px);
  letter-spacing: 5px;
  opacity: .95;
}

.town{
  margin-top: 6px;
  font-size: clamp(14px, 1.8vw, 18px);
  letter-spacing: 2px;
  color: var(--muted);
}

/* ACTION ROW */
.menuHeader{
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--btnGap);

  margin-top: 12px;
  margin-bottom: 6px;

  padding-inline: var(--btnRailPad);
}

/* Buttons */
.cornerBtn{
  width: 92px;
  height: 44px;
  display: grid;
  place-items: center;

  font-size: 12px;
  font-weight: 900;
  letter-spacing: 2px;
  text-transform: uppercase;
  text-decoration: none;

  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12);

  background: var(--copperGrad);
  color: #1a0f0a;

  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.38),
    inset 0 -2px 5px rgba(0,0,0,.35),
    0 10px 22px rgba(0,0,0,.55);

  user-select: none;
  -webkit-tap-highlight-color: transparent;
}
.cornerBtn:hover{
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.48),
    inset 0 -2px 7px rgba(0,0,0,.45),
    0 14px 30px rgba(0,0,0,.65);
}
.cornerBtn:active{ transform: translateY(1px); }

.sub{
  font-size: clamp(14px, 2vw, 18px);
  margin-top: 10px;
}

/* ✅ Only scroll container */
#menu{
  flex: 1 1 auto;
  min-height: 0;

  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  padding:
    calc(var(--wardSafeY) * 0.55)
    calc(var(--pad) + var(--wardSafeX))
    calc(var(--wardSafeY) * 0.75);

  scrollbar-width: none;

  position: relative;
  z-index: 4;

  max-width: var(--menuMaxW);
  margin-inline: auto;
}
#menu::-webkit-scrollbar{ width: 0; height: 0; }

/* Sections */
.section{
  margin: 18px auto 26px;
  max-width: var(--sectionMaxW);
}

.sectionTitle{
  margin: 0 0 12px;
  text-align: center;
  font-size: clamp(18px, 2.6vw, 30px);
  letter-spacing: 6px;
  text-transform: uppercase;
}

/* Items */
.item{
  display: flex;
  justify-content: space-between;
  gap: 14px;
  padding: 11px 0;
  border-bottom: 1px solid rgba(255,255,255,.10);
}
.item:last-child{ border-bottom: none; }

.left{ flex: 1; min-width: 0; }

.name{
  font-size: clamp(18px, 2.2vw, 28px);
  font-weight: 650;
}

.desc{
  margin-top: 6px;
  font-size: clamp(13px, 1.6vw, 18px);
  line-height: 1.25;
  color: var(--muted);
  text-shadow: 0 10px 22px rgba(0,0,0,.65);
}

.price{
  font-size: clamp(16px, 2vw, 24px);
  white-space: nowrap;
}

/* Footer note */
.footerNote{
  padding: 10px 0 18px;
  color: var(--muted);
  font-size: clamp(12px, 1.5vw, 16px);
  text-align: center;
  position: relative;
  z-index: 4;
}

/* Primary text -> copper */
.kicker,
.sectionTitle,
.name,
.price{
  background: var(--copperGrad);
  -webkit-background-clip:text;
  background-clip:text;
  color: transparent;
  -webkit-text-fill-color: transparent;
  text-shadow:
    0 2px 0 rgba(0,0,0,.55),
    0 14px 26px rgba(0,0,0,.72);
}

/* Small text stays whitish */
.town,
.sub,
.desc,
.footerNote{
  color: var(--muted);
  -webkit-text-fill-color: initial;
  background: none;
}

/* ===========================
   MOBILE
   =========================== */

@media (max-width: 520px){
  :root{
    --wardSafeX: 54px;
    --wardSafeY: 54px;

    --btnRailPad: 26px;
    --btnGap: 12px;

    --menuMaxW: 94vw;
    --sectionMaxW: 92vw;
  }

  .panel{ width: 94vw; }

  .cornerBtn{
    width: 68px;
    height: 36px;
    border-radius: 11px;
    font-size: 10px;
    letter-spacing: 1.4px;
  }

  .name{ font-size: clamp(17px, 4.6vw, 22px); }
  .price{ font-size: clamp(15px, 4.2vw, 20px); }
}

@media (max-width: 380px){
  :root{
    --wardSafeX: 62px;
    --btnRailPad: 30px;
    --btnGap: 10px;
  }

  .cornerBtn{
    width: 62px;
    height: 34px;
    font-size: 10px;
    letter-spacing: 1.25px;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  #embers{ display: none; }
}